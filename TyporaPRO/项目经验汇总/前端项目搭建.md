# package.json

```json
{
  "name": "efairy-front",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "vue-cli-service serve --host 127.0.0.1 --port 80",
    "serve": "vue-cli-service serve --host 127.0.0.1 --port 80",
    "build": "vue-cli-service build"
  },
  "dependencies": {
    "animate.css": "^4.1.1",
    "axios": "^0.24.0",
    "bootstrap": "^3.4.1",
    "core-js": "^3.6.5",
    "echarts": "^5.2.2",
    "element-ui": "^2.15.6",
    "es6-promise": "^4.2.8",
    "jquery": "^3.6.0",
    "qs": "^6.10.3",
    "vue": "^2.6.11",
    "vue-router": "^3.5.3",
    "vuex": "^3.6.2"
  },
  "devDependencies": {
    "@vue/cli-plugin-babel": "~4.5.0",
    "@vue/cli-service": "~4.5.0",
    "less": "^3.0.4",
    "less-loader": "^5.0.0",
    "vue-template-compiler": "^2.6.11"
  }
}
```

# 创建项目

```sh
vue create demo
cd demo
```

# 安装vue-router

```sh
npm install vue-router@3 -S #vue2.0对应3版本 vue3.0 对应4版本
```

# 新建router/index.js

```js
import Vue from 'vue'
import Router from 'vue-router'

Vue.use(Router)

export default new Router({
    routes: [
        {
            path: '/',
            component: resolve => require(['../pages/Login'], resolve)
        }
    ]
})

```

# 入口main.js修改

```js
import Vue from 'vue'
import router from '@/router/index'
import App from '@/App'



new Vue({
    el: '#app',
    router,
    render: h => h(App)
})
```

# App.vue

```vue
<template>
  <div id="app">
    <router-view></router-view>
  </div>
</template>

<script>
import HelloWorld from './components/HelloWorld.vue'

export default {
  name: 'App',
  components: {
    HelloWorld
  }
}
</script>

<style lang="less">

</style>

```

# Login.vue

```vue
<template>
  <div>
    <h1>
      你好
    </h1>
  </div>
</template>

<script>
export default {
  name: "Login"
}
</script>

<style scoped>

</style>
```

# 安装webpack

```sh
npm install less less-loader --save-dev
```

## webpack.config.js

```js
const path = require('path') // 引用path模块

module.exports = {  // 这里是commrnt.js语法
    // 入口文件
    entry:"./src/main.js",
    // 打包后的出口文件
    output:{
        // 输出的路径  是绝对路径(导入path模块) 这里是用node来做的
        path:path.resolve(__dirname,'build'),
        // 输出的文件名称
        filename:'build.js',
    },
    // loader的配置
    module:{
        rules:[
            // 详细loader配置
            
            // 打包css的配置
            {
                // 使用正则表达式,匹配那些文件
                test: /\.css$/,
                use:[
                    // use数组中loader执行顺序, 从右到左, 从下到上, 依次执行
                    // 创建style标签, 将js中的样式资源插入进行, 添加到head中生效
                    'style-loader',
                    // 将css文件变成commitjs模块加载js中, 里面的内容是样式字符串
                    'css-loader',
                    
                ]
            },
            {
                test: /\.less$/i,
                loader: [
                    // compiles Less to CSS
                    'style-loader',
                    'css-loader',
                    'less-loader',
                ],
            },
        ]
    },
    // 使用开发模式打包
    mode:"development"
}
```

## 配置 webpack-dev-server

webpack-dev-server 可以让 webpack 监听项目源代码的变化，从而进行自动打包构建。

运行如下的命令，即可在项目中安装此插件：

```bash
npm install webpack-dev-server@3.11.2 -D
```



① 修改 package.json -> scripts 中的 dev 命令如下：

```json
"scripts": {
    "dev": "webpack serve"
}
```

② 再次运行 npm run dev 命令，重新进行项目的打包

```bash
npm run dev
```

# electron-builder

electron-builder是一个开箱即用的构建跨平台electron桌面应用的解决方案

执行以下命令安装electron-builder

```bash
vue add electron-builder
```

安装成功后，可以看见package.json 中已经增加了几个命令

```json
  "scripts": {
    "serve": "vue-cli-service serve",
    "build": "vue-cli-service build",
    "lint": "vue-cli-service lint",
    "electron:build": "vue-cli-service electron:build",
    "electron:serve": "vue-cli-service electron:serve",
    "postinstall": "electron-builder install-app-deps",
    "postuninstall": "electron-builder install-app-deps"
  },
```

这里将用到的两个命令是

```bash
npm run electron:serve
# 启动调试
npm run electron:build
# 生成项目
```

在命令行中输入

```bash
npm run electron:serve
```

耐心等待，成功后 应用程序就运行起来了

![img](https://pic2.zhimg.com/80/v2-0069c74412d93283dabe792881b14375_720w.jpg)自动配置中，会打开右侧的调试工具



运行以下命令将项目打包

```bash
npm run electron:build
```

如果在国内的话，可能会遇到下载依赖特别慢的问题

很多解决方案是通过手动下载 electron 到 cache 目录

其实只需要配置 electron 的下载源即可

在项目根目录新建 vue.config.js,并添加以下内容

```js
//vue.config.js
module.exports = {
    pluginOptions: {
        electronBuilder: {
            builderOptions: {
                ...
                "electronDownload": {
                    "mirror": "https://npm.taobao.org/mirrors/electron/"
                }
            }
        }
    }
}
```

即配置electron的下载路径为[https://npm.taobao.org/mirrors/electron/](https://link.zhihu.com/?target=https%3A//npm.taobao.org/mirrors/electron/)

配置之后

再次运行以下命令打包

```bash
npm run electron:build
```

可以在输出中看见下载路径为配置的路径了

![img](https://pic1.zhimg.com/80/v2-42b2c4f32c22217a19afdd542fab68c0_720w.png)Build complete！

build完成后，可以在dist_electron中看见打包完成的应用啦！

直接运行dmg/exe，可以看到程序成功运行起来啦

## 热更新

首先，安装这个npm模块：

```sh
npm install --save-dev electron-reloader
```

然后，在程序入口文件（一般是index.js）中最下方加入以下代码：

```js
try {
  require('electron-reloader')(module,{});
} catch (_) {}
```

## 窗口无边框模式

```js
const win = new BrowserWindow({
        width: 1400,
        height: 800,
        frame: false, // false为无边框模式
        webPreferences: {
            
            // Use pluginOptions.nodeIntegration, leave this alone
            // See nklayman.github.io/vue-cli-plugin-electron-builder/guide/security.html#node-integration for more info
            nodeIntegration: process.env.ELECTRON_NODE_INTEGRATION,
            contextIsolation: !process.env.ELECTRON_NODE_INTEGRATION
        }
    })
```

